import{v as o}from"./index-Cn49cqZF.js";function n(e){return typeof e!="string"?e:o.sanitize(e,{ALLOWED_TAGS:[]}).trim()}function s(e){return typeof e!="string"?e:o.sanitize(e,{ALLOWED_TAGS:["b","i","em","strong","br","p"],ALLOWED_ATTR:[]}).trim()}function l(e){if(typeof e!="string")return null;const i=n(e).toLowerCase();return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)?i:null}function u(e){if(typeof e!="string")return null;const i=e.replace(/[^\d+\s\-()]/g,"").trim();return i.replace(/\D/g,"").length<10?null:i}function c(e){if(typeof e!="string")return null;const i=e.replace(/[^a-zA-Z0-9\s]/g,"").trim().toUpperCase();if(!/^[A-Z]{1,2}\d[A-Z\d]?\s*\d[A-Z]{2}$/i.test(i))return i;const r=i.replace(/\s/g,"");return r.length>=5?r.slice(0,-3)+" "+r.slice(-3):i}function p(e){return{...e,firstName:e.firstName?n(e.firstName):null,lastName:e.lastName?n(e.lastName):null,email:e.email?l(e.email):null,phone:e.phone?u(e.phone):null,address:e.address?n(e.address):null,postcode:e.postcode?c(e.postcode):null,notes:e.notes?s(e.notes):null,source:e.source?n(e.source):null}}function m(e){return{...e,title:e.title?n(e.title):null,location:e.location?n(e.location):null,description:e.description?s(e.description):null,requirements:e.requirements?s(e.requirements):null}}function g(e){return s(e)}function z(e){return typeof e!="string"?!1:[/<script/i,/javascript:/i,/on\w+\s*=/i,/<iframe/i,/<object/i,/<embed/i,/data:/i,/vbscript:/i].some(t=>t.test(e))}export{g as a,m as b,z as c,p as s};
