import{c as z,y as d,x as e,X as L,C as O,J as v,S as I,K as _}from"./index-Cn49cqZF.js";import{B as P}from"./Button-D3AMkBxW.js";import{M as $}from"./Modal-DXTeyNQ8.js";import{a as R,f as V,v as h}from"./jobs-C4D7WUad.js";import{C as H}from"./candidates-Co5N_4c6.js";const T=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ne=z("external-link",T);const U=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ie=z("file-text",U);const K=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],X=z("file",K);const G=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Q=z("upload",G);function W({onFileSelect:n,accept:r=[".pdf",".doc",".docx"],maxSize:c=10*1024*1024,currentFile:s=null,currentFileName:y=null,label:M="Upload File",hint:D="PDF, DOC, or DOCX up to 10MB"}){const[x,o]=d.useState(!1),[k,m]=d.useState(null),t=d.useRef(null),u=r.join(","),B=a=>{const l="."+a.name.split(".").pop().toLowerCase();return r.includes(l)?a.size>c?`File is too large. Maximum size is ${Math.round(c/1048576)}MB.`:null:`Invalid file type. Please upload ${r.join(", ")} files only.`},j=d.useCallback(a=>{m(null);const l=B(a);if(l){m(l);return}n(a)},[n,r,c]),p=a=>{a.preventDefault(),a.stopPropagation(),o(!0)},F=a=>{a.preventDefault(),a.stopPropagation(),o(!1)},N=a=>{a.preventDefault(),a.stopPropagation()},w=a=>{a.preventDefault(),a.stopPropagation(),o(!1);const l=a.dataTransfer.files;l&&l.length>0&&j(l[0])},E=a=>{const l=a.target.files;l&&l.length>0&&j(l[0])},g=()=>{t.current?.click()},S=a=>{a.stopPropagation(),m(null),n(null),t.current&&(t.current.value="")},b=s?.name||y;return e.jsxs("div",{className:"file-upload-wrapper",children:[M&&e.jsx("label",{className:"file-upload-label",children:M}),e.jsxs("div",{className:`file-upload-zone ${x?"file-upload-zone-dragging":""} ${b?"file-upload-zone-has-file":""}`,onDragEnter:p,onDragLeave:F,onDragOver:N,onDrop:w,onClick:g,role:"button",tabIndex:0,onKeyDown:a=>a.key==="Enter"&&g(),children:[e.jsx("input",{ref:t,type:"file",accept:u,onChange:E,className:"file-upload-input"}),b?e.jsxs("div",{className:"file-upload-preview",children:[e.jsx("div",{className:"file-upload-file-icon",children:e.jsx(X,{size:24})}),e.jsxs("div",{className:"file-upload-file-info",children:[e.jsx("span",{className:"file-upload-file-name",children:b}),s&&e.jsx("span",{className:"file-upload-file-size",children:Y(s.size)})]}),e.jsx("button",{type:"button",className:"file-upload-remove",onClick:S,"aria-label":"Remove file",children:e.jsx(L,{size:18})})]}):e.jsxs("div",{className:"file-upload-placeholder",children:[e.jsx("div",{className:"file-upload-icon",children:e.jsx(Q,{size:24})}),e.jsxs("div",{className:"file-upload-text",children:[e.jsx("span",{className:"file-upload-text-primary",children:"Click to upload or drag and drop"}),e.jsx("span",{className:"file-upload-text-secondary",children:D})]})]})]}),k&&e.jsxs("div",{className:"file-upload-error",children:[e.jsx(O,{size:14}),e.jsx("span",{children:k})]})]})}function Y(n){if(n===0)return"0 Bytes";const r=1024,c=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(n)/Math.log(r));return parseFloat((n/Math.pow(r,s)).toFixed(1))+" "+c[s]}const Z={firstName:[h.required],lastName:[h.required],email:[h.required,h.email],phone:[h.required,h.phone],postcode:[h.postcode]},ee={firstName:"First name",lastName:"Last name",email:"Email",phone:"Phone number",postcode:"Postcode"};function re({isOpen:n,onClose:r,onSubmit:c,candidate:s=null,loading:y=!1,preSelectedJobId:M=null}){const D=!!s,x=()=>({firstName:s?.firstName||"",lastName:s?.lastName||"",email:s?.email||"",phone:s?.phone||"",address:s?.address||"",postcode:s?.postcode||"",jobId:s?.jobId||M||"",source:s?.source||"",notes:s?.notes||""}),{values:o,errors:k,touched:m,handleChange:t,handleBlur:u,validate:B,resetForm:j,getFieldError:p}=R(x(),Z,{debounceMs:300,validateOnChange:!0,validateOnBlur:!0,fieldNames:ee}),[F,N]=d.useState(null),[w,E]=d.useState([]),[g,S]=d.useState(!0);d.useEffect(()=>{async function i(){try{const C=await V({status:"active"});E(C)}catch(C){console.error("Error fetching jobs:",C)}finally{S(!1)}}n&&i()},[n]),d.useEffect(()=>{n&&(j(x()),N(null))},[n,s?.id]);const b=i=>{N(i)},a=async i=>{if(i.preventDefault(),!B())return;const C=w.find(J=>J.id===o.jobId),A={...o,jobTitle:C?.title||null};await c(A,F)},l=()=>{j(x()),N(null),r()},f=i=>m[i]&&o[i]&&!k[i],q=w.map(i=>({value:i.id,label:`${i.title} - ${i.location}`}));return e.jsx($,{isOpen:n,onClose:l,title:D?"Edit Candidate":"Add New Candidate",size:"lg",footer:e.jsxs(e.Fragment,{children:[e.jsx(P,{variant:"outline",onClick:l,disabled:y,children:"Cancel"}),e.jsx(P,{onClick:a,loading:y,children:D?"Save Changes":"Add Candidate"})]}),children:e.jsxs("form",{onSubmit:a,className:"candidate-form",children:[e.jsx("div",{className:"candidate-form-section",children:e.jsx(W,{label:"CV / Resume",onFileSelect:b,currentFile:F,currentFileName:s?.cvFileName,accept:[".pdf",".doc",".docx"],hint:"PDF, DOC, or DOCX up to 10MB"})}),e.jsxs("div",{className:"candidate-form-section",children:[e.jsx("h4",{className:"candidate-form-section-title",children:"Personal Information"}),e.jsxs("div",{className:"candidate-form-row candidate-form-row-2col",children:[e.jsx(v,{label:"First Name",name:"firstName",value:o.firstName,onChange:t,onBlur:u,placeholder:"John",error:p("firstName"),success:f("firstName"),required:!0}),e.jsx(v,{label:"Last Name",name:"lastName",value:o.lastName,onChange:t,onBlur:u,placeholder:"Smith",error:p("lastName"),success:f("lastName"),required:!0})]}),e.jsxs("div",{className:"candidate-form-row candidate-form-row-2col",children:[e.jsx(v,{label:"Email",name:"email",type:"email",value:o.email,onChange:t,onBlur:u,placeholder:"john.smith@email.com",error:p("email"),success:f("email"),required:!0}),e.jsx(v,{label:"Phone",name:"phone",type:"tel",value:o.phone,onChange:t,onBlur:u,placeholder:"07123 456789",error:p("phone"),success:f("phone"),required:!0})]}),e.jsxs("div",{className:"candidate-form-row candidate-form-row-2col",children:[e.jsx(v,{label:"Address",name:"address",value:o.address,onChange:t,placeholder:"123 Main Street, Manchester",hint:"Optional"}),e.jsx(v,{label:"Postcode",name:"postcode",value:o.postcode,onChange:t,onBlur:u,placeholder:"M1 1AA",error:p("postcode"),success:f("postcode"),hint:m.postcode?void 0:"Optional"})]})]}),e.jsxs("div",{className:"candidate-form-section",children:[e.jsx("h4",{className:"candidate-form-section-title",children:"Application Details"}),e.jsxs("div",{className:"candidate-form-row candidate-form-row-2col",children:[e.jsx(I,{label:"Job Position",name:"jobId",value:o.jobId,onChange:t,options:q,placeholder:g?"Loading jobs...":"Select a job position",disabled:g}),e.jsx(I,{label:"Source",name:"source",value:o.source,onChange:t,options:H,placeholder:"How did they apply?"})]}),e.jsx("div",{className:"candidate-form-row",children:e.jsx(_,{label:"Notes",name:"notes",value:o.notes,onChange:t,placeholder:"Any additional notes about this candidate...",rows:3,hint:"Optional"})})]})]})})}export{re as C,ne as E,ie as F,Q as U};
