import{c as S,x as a,A as C,a as N,d as g,t as m,q as l,w as r,T as u,l as U,o as A,j as B,L as G,z as J,H as K,N as k,U as F,F as V}from"./index-NO_tzWV3.js";import{B as $}from"./Button-DKTA78MY.js";import{H as E,C as p,a as w,B as M}from"./Header-ifEcOLS6.js";import{u as I}from"./useQuery-4a8dzvSD.js";import{g as O,b as Q}from"./candidates-DJnU1mRt.js";import{f as P,i as W}from"./interviews-Bvo0cGsx.js";import{C as L}from"./calendar-a-ysl3sN.js";import{C as Y}from"./chevron-right-Df6H1ViZ.js";import{P as X}from"./plus-zFcwYzlL.js";import"./sanitize-DDeMpGng.js";const Z=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],H=S("arrow-right",Z);const aa=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],sa=S("trending-up",aa);const ea=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ta=S("user-plus",ea);function x({variant:t="text",width:d,height:n,count:e=1,className:c=""}){const o=Array.from({length:e},(b,y)=>a.jsx("div",{className:`skeleton skeleton--${t} ${c}`,style:{width:d,height:n},"aria-hidden":"true"},y));return e===1?o[0]:a.jsx(a.Fragment,{children:o})}async function na(){const t=N(g,"candidates"),d=N(g,"jobs"),n=N(g,"interviews"),e=new Date;e.setHours(0,0,0,0);const c=new Date(e);c.setDate(c.getDate()+1);const o=new Date(e);o.setDate(o.getDate()+7);const[b,y,j,q,z,R,s,i,f]=await Promise.all([m(l(t)),m(l(t,r("status","==","new"))),m(l(t,r("status","==","approved"))),m(l(t,r("status","==","rejected"))),m(l(t,r("status","==","withdrawn"))),m(l(d)),m(l(d,r("status","==","active"))),m(l(n,r("status","==","scheduled"),r("dateTime",">=",u.fromDate(e)),r("dateTime","<",u.fromDate(c)))),m(l(n,r("status","==","scheduled"),r("dateTime",">=",u.fromDate(e)),r("dateTime","<",u.fromDate(o))))]),h=b.data().count,v=y.data().count,D=j.data().count,T=q.data().count+z.data().count,_=h-v-D-T;return{candidates:{total:h,new:v,inProgress:_,approved:D},jobs:{total:R.data().count,active:s.data().count},interviews:{today:i.data().count,upcoming:f.data().count}}}async function da(t=5){const d=N(g,"candidates"),n=l(d,A("createdAt","desc"),U(t));return(await B(n)).docs.map(c=>({id:c.id,...c.data()}))}async function ia(t=5){const d=N(g,"interviews"),n=u.now(),e=l(d,r("status","==","scheduled"),r("dateTime",">=",n),A("dateTime","asc"),U(t));return(await B(e)).docs.map(o=>({id:o.id,...o.data()}))}async function ra(){const t=new Date;t.setHours(0,0,0,0);const d=new Date(t);d.setDate(d.getDate()+1);const n=N(g,"interviews"),e=l(n,r("status","==","scheduled"),r("dateTime",">=",u.fromDate(t)),r("dateTime","<",u.fromDate(d)),A("dateTime","asc"));return(await B(e)).docs.map(o=>({id:o.id,...o.data()}))}function oa(){const{data:t,isLoading:d,error:n,refetch:e}=I({queryKey:C.dashboard.stats(),queryFn:na,staleTime:6e4});return{candidates:t?.candidates||{total:0,new:0,inProgress:0,approved:0},jobs:t?.jobs||{total:0,active:0},interviews:t?.interviews||{today:0,upcoming:0},loading:d,error:n,refetch:e}}function ca(t=5){const{data:d,isLoading:n,error:e}=I({queryKey:C.dashboard.recentCandidates(t),queryFn:()=>da(t),staleTime:3e4});return{candidates:d||[],loading:n,error:e}}function la(t=5){const{data:d,isLoading:n,error:e}=I({queryKey:C.interviews.upcoming(t),queryFn:()=>ia(t),staleTime:6e4});return{interviews:d||[],loading:n,error:e}}function ha(){const{data:t,isLoading:d,error:n}=I({queryKey:C.interviews.today(),queryFn:ra,staleTime:6e4});return{interviews:t||[],loading:d,error:n}}function ya(){const{toggleMobileMenu:t}=G(),{userProfile:d}=J(),n=K(),e=oa(),{candidates:c,loading:o}=ca(5),{interviews:b,loading:y}=la(5),{interviews:j}=ha(),q=()=>{const s=new Date().getHours();return s<12?"Good morning":s<18?"Good afternoon":"Good evening"},z=s=>{if(!s)return"";const i=s.toDate?s.toDate():new Date(s),h=new Date-i,v=Math.floor(h/6e4),D=Math.floor(h/36e5),T=Math.floor(h/864e5);return v<1?"Just now":v<60?`${v}m ago`:D<24?`${D}h ago`:T<7?`${T}d ago`:i.toLocaleDateString("en-GB",{day:"numeric",month:"short"})},R=s=>{if(!s)return"";const i=s.toDate?s.toDate():new Date(s),f=new Date,h=new Date(f);return h.setDate(h.getDate()+1),i.toDateString()===f.toDateString()?"Today":i.toDateString()===h.toDateString()?"Tomorrow":i.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})};return a.jsxs(a.Fragment,{children:[a.jsx(E,{title:`${q()}, ${d?.displayName?.split(" ")[0]||"there"}!`,subtitle:"Here's what's happening with your recruitment today",onMenuClick:t}),a.jsxs("div",{className:"page",children:[j.length>0&&a.jsxs("div",{className:"dashboard-today-alert",children:[a.jsx("div",{className:"today-alert-icon",children:a.jsx(L,{size:20})}),a.jsxs("div",{className:"today-alert-content",children:[a.jsxs("span",{className:"today-alert-title",children:["You have ",j.length," interview",j.length!==1?"s":""," today"]}),a.jsx("span",{className:"today-alert-times",children:j.map((s,i)=>a.jsxs("span",{children:[P(s.dateTime),i<j.length-1?", ":""]},s.id))})]}),a.jsxs(k,{to:"/candidates",className:"today-alert-link",children:["View all ",a.jsx(Y,{size:16})]})]}),a.jsxs("div",{className:"dashboard-stats",children:[a.jsx(p,{className:"dashboard-stat-card",onClick:()=>n("/candidates"),children:a.jsxs(w,{children:[a.jsx("div",{className:"stat-icon stat-icon-primary",children:a.jsx(F,{size:24})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-value",children:e.loading?"...":e.candidates.total}),a.jsx("span",{className:"stat-label",children:"Total Candidates"})]}),a.jsxs("div",{className:"stat-breakdown",children:[a.jsxs("span",{className:"stat-breakdown-item stat-new",children:[e.candidates.new," new"]}),a.jsxs("span",{className:"stat-breakdown-item stat-progress",children:[e.candidates.inProgress," in progress"]})]})]})}),a.jsx(p,{className:"dashboard-stat-card",onClick:()=>n("/jobs"),children:a.jsxs(w,{children:[a.jsx("div",{className:"stat-icon stat-icon-success",children:a.jsx(V,{size:24})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-value",children:e.loading?"...":e.jobs.active}),a.jsx("span",{className:"stat-label",children:"Active Jobs"})]}),a.jsx("div",{className:"stat-breakdown",children:a.jsxs("span",{className:"stat-breakdown-item",children:[e.jobs.total," total listings"]})})]})}),a.jsx(p,{className:"dashboard-stat-card",children:a.jsxs(w,{children:[a.jsx("div",{className:"stat-icon stat-icon-warning",children:a.jsx(L,{size:24})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-value",children:e.loading?"...":e.interviews.today}),a.jsx("span",{className:"stat-label",children:"Interviews Today"})]}),a.jsx("div",{className:"stat-breakdown",children:a.jsxs("span",{className:"stat-breakdown-item",children:[e.interviews.upcoming," this week"]})})]})}),a.jsx(p,{className:"dashboard-stat-card",children:a.jsxs(w,{children:[a.jsx("div",{className:"stat-icon stat-icon-info",children:a.jsx(sa,{size:24})}),a.jsxs("div",{className:"stat-content",children:[a.jsx("span",{className:"stat-value",children:e.loading?"...":e.candidates.approved}),a.jsx("span",{className:"stat-label",children:"Approved"})]}),a.jsx("div",{className:"stat-breakdown",children:a.jsx("span",{className:"stat-breakdown-item stat-success",children:"Ready to hire"})})]})})]}),a.jsxs("div",{className:"dashboard-quick-actions",children:[a.jsx($,{leftIcon:a.jsx(ta,{size:16}),onClick:()=>n("/candidates"),children:"Add Candidate"}),a.jsx($,{variant:"outline",leftIcon:a.jsx(X,{size:16}),onClick:()=>n("/jobs"),children:"Post New Job"})]}),a.jsxs("div",{className:"dashboard-grid",children:[a.jsxs(p,{className:"dashboard-card",children:[a.jsxs("div",{className:"dashboard-card-header",children:[a.jsx("h3",{className:"dashboard-card-title",children:"Recent Candidates"}),a.jsxs(k,{to:"/candidates",className:"dashboard-card-link",children:["View all ",a.jsx(H,{size:14})]})]}),a.jsx(w,{className:"dashboard-card-body",children:o?a.jsx("div",{className:"dashboard-candidates-list",children:[1,2,3,4,5].map(s=>a.jsxs("div",{className:"dashboard-candidate-item dashboard-candidate-skeleton",children:[a.jsx(x,{variant:"avatar"}),a.jsxs("div",{className:"dashboard-candidate-info",children:[a.jsx(x,{variant:"text",width:"120px",height:"14px"}),a.jsx(x,{variant:"text",width:"80px",height:"12px"})]}),a.jsx("div",{className:"dashboard-candidate-meta",children:a.jsx(x,{variant:"text",width:"60px",height:"22px"})})]},s))}):c.length===0?a.jsxs("div",{className:"dashboard-empty",children:[a.jsx(F,{size:32}),a.jsx("p",{children:"No candidates yet"}),a.jsx($,{size:"sm",onClick:()=>n("/candidates"),children:"Add First Candidate"})]}):a.jsx("div",{className:"dashboard-candidates-list",children:c.map(s=>{const i=O(s.status);return a.jsxs(k,{to:`/candidates/${s.id}`,className:"dashboard-candidate-item",children:[a.jsx("div",{className:"dashboard-candidate-avatar",children:Q(s)}),a.jsxs("div",{className:"dashboard-candidate-info",children:[a.jsxs("span",{className:"dashboard-candidate-name",children:[s.firstName," ",s.lastName]}),a.jsx("span",{className:"dashboard-candidate-job",children:s.jobTitle||"No position"})]}),a.jsxs("div",{className:"dashboard-candidate-meta",children:[a.jsx(M,{variant:i.color,size:"sm",children:i.label}),a.jsx("span",{className:"dashboard-candidate-time",children:z(s.createdAt)})]})]},s.id)})})})]}),a.jsxs(p,{className:"dashboard-card",children:[a.jsxs("div",{className:"dashboard-card-header",children:[a.jsx("h3",{className:"dashboard-card-title",children:"Upcoming Interviews"}),a.jsxs(k,{to:"/candidates",className:"dashboard-card-link",children:["View all ",a.jsx(H,{size:14})]})]}),a.jsx(w,{className:"dashboard-card-body",children:y?a.jsx("div",{className:"dashboard-interviews-list",children:[1,2,3,4,5].map(s=>a.jsxs("div",{className:"dashboard-interview-item dashboard-interview-skeleton",children:[a.jsxs("div",{className:"dashboard-interview-date",children:[a.jsx(x,{variant:"text",width:"60px",height:"14px"}),a.jsx(x,{variant:"text",width:"40px",height:"12px"})]}),a.jsxs("div",{className:"dashboard-interview-info",children:[a.jsx(x,{variant:"text",width:"100px",height:"14px"}),a.jsx(x,{variant:"text",width:"120px",height:"12px"})]})]},s))}):b.length===0?a.jsxs("div",{className:"dashboard-empty",children:[a.jsx(L,{size:32}),a.jsx("p",{children:"No upcoming interviews"}),a.jsx("span",{className:"dashboard-empty-hint",children:"Schedule interviews from candidate profiles"})]}):a.jsx("div",{className:"dashboard-interviews-list",children:b.map(s=>{const i=W(s.dateTime);return a.jsxs(k,{to:`/candidates/${s.candidateId}`,className:`dashboard-interview-item ${i?"interview-today":""}`,children:[a.jsxs("div",{className:"dashboard-interview-date",children:[a.jsx("span",{className:"interview-day",children:R(s.dateTime)}),a.jsx("span",{className:"interview-time",children:P(s.dateTime)})]}),a.jsxs("div",{className:"dashboard-interview-info",children:[a.jsx("span",{className:"dashboard-interview-name",children:s.candidateName}),a.jsxs("span",{className:"dashboard-interview-type",children:[s.type==="trial"?"Trial Day":"Interview",s.location&&` Â· ${s.location}`]})]}),i&&a.jsx(M,{variant:"success",size:"sm",children:"Today"})]},s.id)})})})]})]})]})]})}export{ya as default};
