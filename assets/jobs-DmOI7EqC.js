import{y as o,a as J,d as h,q as i,o as k,w as g,b as z,f as K,s as P,e as F,u as W,h as G,j as H,t as E}from"./index-BdTvf1OG.js";import{b as M,c as Y}from"./sanitize-Crbaelqk.js";const se={required:(e,t="This field")=>!e||typeof e=="string"&&!e.trim()?`${t} is required`:null,email:e=>e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:"Please enter a valid email address":null,phone:e=>{if(!e)return null;const t=e.replace(/[\s\-\(\)\.]/g,"");return/^(\+44|0)[0-9]{9,12}$/.test(t)?null:"Please enter a valid UK phone number"},postcode:e=>e?/^[A-Z]{1,2}\d[A-Z\d]?\s*\d[A-Z]{2}$/i.test(e.trim())?null:"Please enter a valid UK postcode":null,minLength:e=>(t,r="This field")=>t&&t.length<e?`${r} must be at least ${e} characters`:null,maxLength:e=>(t,r="This field")=>t&&t.length>e?`${r} must be no more than ${e} characters`:null,pattern:(e,t)=>r=>r?e.test(r)?null:t:null,url:e=>{if(!e)return null;try{return new URL(e),null}catch{return"Please enter a valid URL"}},number:e=>e&&isNaN(Number(e))?"Please enter a valid number":null,min:e=>(t,r="Value")=>t&&Number(t)<e?`${r} must be at least ${e}`:null,max:e=>(t,r="Value")=>t&&Number(t)>e?`${r} must be no more than ${e}`:null,match:(e,t="Values do not match")=>r=>r&&r!==e?t:null,custom:e=>e};function Q(e,t){const r=o.useRef(null),c=o.useCallback((...n)=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{e(...n)},t)},[e,t]);return o.useEffect(()=>()=>{r.current&&clearTimeout(r.current)},[]),c}function ae(e={},t={},r={}){const{debounceMs:c=300,validateOnChange:n=!0,validateOnBlur:m=!0,fieldNames:C={}}=r,[b,v]=o.useState(e),[T,p]=o.useState({}),[f,A]=o.useState({}),[x,$]=o.useState(!1);o.useEffect(()=>{v(e),p({}),A({})},[JSON.stringify(e)]);const R=o.useCallback((s,a)=>{const l=t[s];if(!l||!Array.isArray(l))return null;const u=C[s]||s;for(const d of l){const S=d(a,u);if(S)return S}return null},[t,C]),B=o.useCallback(()=>{const s={};let a=!1;Object.keys(t).forEach(u=>{const d=R(u,b[u]);d&&(s[u]=d,a=!0)}),p(s);const l={};return Object.keys(t).forEach(u=>{l[u]=!0}),A(l),!a},[t,b,R]),O=Q((s,a)=>{const l=R(s,a);p(u=>({...u,[s]:l})),$(!1)},c),N=o.useCallback(s=>{const{name:a,value:l,type:u,checked:d}=s.target,S=u==="checkbox"?d:l;v(Z=>({...Z,[a]:S})),n&&f[a]&&($(!0),O(a,S))},[n,f,O]),w=o.useCallback(s=>{const{name:a,value:l}=s.target;if(A(u=>({...u,[a]:!0})),m){const u=R(a,l);p(d=>({...d,[a]:u}))}},[m,R]),j=o.useCallback((s,a)=>{v(l=>({...l,[s]:a})),n&&f[s]&&O(s,a)},[n,f,O]),L=o.useCallback((s,a)=>{p(l=>({...l,[s]:a}))},[]),q=o.useCallback((s,a=!0)=>{A(l=>({...l,[s]:a}))},[]),I=o.useCallback((s=e)=>{v(s),p({}),A({})},[e]),_=o.useCallback(s=>f[s]?T[s]:null,[f,T]),U=Object.keys(T).every(s=>!T[s]),D=JSON.stringify(b)!==JSON.stringify(e),V=o.useCallback(s=>({name:s,value:b[s]||"",onChange:N,onBlur:w,error:_(s)}),[b,N,w,_]);return{values:b,errors:T,touched:f,isValidating:x,isValid:U,isDirty:D,handleChange:N,handleBlur:w,setFieldValue:j,setFieldError:L,setFieldTouched:q,getFieldError:_,getFieldProps:V,validate:B,resetForm:I,setValues:v}}const X=[{value:"dispenser",label:"Dispenser"},{value:"counter_assistant",label:"Counter Assistant"},{value:"pharmacist",label:"Pharmacist"},{value:"delivery_driver",label:"Delivery Driver"},{value:"pharmacy_technician",label:"Pharmacy Technician"},{value:"prereg_pharmacist",label:"Pre-reg Pharmacist"},{value:"cleaner",label:"Cleaner"},{value:"head_office",label:"Head Office"},{value:"other",label:"Other"}],ee=[{value:"active",label:"Active",color:"success"},{value:"paused",label:"Paused",color:"warning"},{value:"closed",label:"Closed",color:"gray"}],ne=[{value:"full_time",label:"Full Time"},{value:"part_time",label:"Part Time"},{value:"temporary",label:"Temporary"},{value:"contract",label:"Contract"}],y="jobs";async function le(e,t){const r=J(h,y),c=M(e);Y(JSON.stringify(e))&&console.warn("Suspicious content detected in job data, sanitising...");const n={title:c.title,category:e.category,location:c.location,description:c.description||"",status:"active",entityId:e.entityId||null,branchId:e.branchId||null,salary:e.salary||null,contractType:e.contractType||"full_time",hoursPerWeek:e.hoursPerWeek||null,createdBy:t,createdAt:P(),updatedAt:P(),closedAt:null};return{id:(await K(r,n)).id,...n}}async function oe(e={}){const t=J(h,y);let r=i(t,k("createdAt","desc"));return e.status&&e.status!=="all"&&(r=i(t,g("status","==",e.status),k("createdAt","desc"))),e.category&&e.category!=="all"&&(r=i(t,g("category","==",e.category),k("createdAt","desc"))),(await H(r)).docs.map(n=>({id:n.id,...n.data()}))}function ce(e,t={}){const r=J(h,y);let c=i(r,k("createdAt","desc"));return t.status&&t.status!=="all"&&(c=i(r,g("status","==",t.status),k("createdAt","desc"))),z(c,n=>{const m=n.docs.map(C=>({id:C.id,...C.data()}));e(m)},n=>{console.error("Error subscribing to jobs:",n)})}async function ue(e,t){const r=F(h,y,e),c={...t,updatedAt:P()};return t.status==="closed"&&(c.closedAt=P()),await W(r,c),{id:e,...c}}async function ie(e){const t=F(h,y,e);await G(t)}async function de(){const e=J(h,y),[t,r,c,n]=await Promise.all([E(i(e)),E(i(e,g("status","==","active"))),E(i(e,g("status","==","paused"))),E(i(e,g("status","==","closed")))]);return{total:t.data().count,active:r.data().count,paused:c.data().count,closed:n.data().count}}function fe(e){return X.find(r=>r.value===e)?.label||e}function be(e){return ee.find(r=>r.value===e)||{value:e,label:e,color:"gray"}}export{ne as C,X as J,ae as a,be as b,le as c,ie as d,fe as e,oe as f,de as g,ce as s,ue as u,se as v};
